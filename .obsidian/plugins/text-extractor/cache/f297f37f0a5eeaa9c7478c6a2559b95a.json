{"path":"media/ramoser2000.pdf","text":"IEEE TRANSACTIONS ON REHABILITATION ENGINEERING, VOL. 8, NO. 4, DECEMBER 2000 441 Optimal Spatial Filtering of Single Trial EEG During Imagined Hand Movement Herbert Ramoser, Johannes Müller-Gerking, and Gert Pfurtscheller Abstract—The development of an electroencephalograph (EEG)-based brain-computer interface (BCI) requires rapid and reliable discrimination of EEG patterns, e.g., associated with imaginary movement. One-sided hand movement imagination results in EEG changes located at contra- and ipsilateral central areas. We demonstrate that spatial filters for multichannel EEG effectively extract discriminatory information from two popula- tions of single-trial EEG, recorded during left- and right-hand movement imagery. The best classification results for three subjects are 90.8%, 92.7%, and 99.7%. The spatial filters are estimated from a set of data by the method of common spatial patterns and reflect the specific activation of cortical areas. The method performs a weighting of the electrodes according to their importance for the classification task. The high recognition rates and computational simplicity make it a promising method for an EEG-based brain–computer interface. Index Terms—Assistive communication, electroencephalograph (EEG) classification, event-related desynchronization (ERD), mu rhythm, prosthesis, sensorimotor cortex. I. INTRODUCTION P ATIENTS in a late stage of amyotropic lateral sclerosis (ALS) or suffering from a locked-in syndrome are not able to produce any voluntary muscle movements. Sensory and cog- nitive functions of the brain are only minimally affected by such a disease. One possibility to open a communication channel for these patients is to use electroencephalograph (EEG) signals to control an assistive device that allows, for example, the selec- tion of letters on a screen [brain–computer interface (BCI)]. It has been shown that the imagination of a limb activation can modify brain electrical activity [1]. Depending on the type of motor imagery, different EEG patterns can be obtained. Activa- tion of hand area neurons either by preparation for a real move- ment or by imagination of the movement is accompanied by an circumscribed event-related desynchronization (ERD) [2] fo- cused at the hand area [3]. In a number of experiments, we found that EEG signals recorded from two bipolar channels over the left- and right-hand areas during imagined one-sided hand movements could be Manuscript received August 10, 1998; revised March 22, 1999. This work was supported by the Austrian Fonds zur Förderung der wissenschaftlichen Forschung under Project P11208MED. H. Ramoser is with the Department of Medical Informatics, Institute of Biomedical Engineering, Graz University of Technology, Graz A-8010, Austria (e-mail: ramoser@dpmi.tu-graz.ac.at). J. Müller-Gerking is with HLRZ, Forschungszentrum, Jülich D-52425 Ger- many. G. Pfurtscheller is with the Ludwig Boltzmann Institute of Medical Infor- matics and Neuroinformatics, Graz University of Technology, Graz 8010, Aus- tria (e-mail: pfu@dpmi.tu-graz.ac.at). Publisher Item Identifier S 1063-6528(00)09838-4. Fig. 1. Timing of the movement imagery task. The cue stimulus in form of an arrow gives the side of imagination. differentiated with an accuracy of about 85% [3] (accuracy refers to the number of correctly classified trials divided by the overall number of trials). This accuracy compares quite well to other studies [4] but it is still too low for a BCI. In current prototypes of a BCI, patients with ALS need about one minute to select a letter, when the single trial accuracy is 80% [17]. If we could achieve a classification accuracy close to 100%, the required time for selection of a letter would be dramatically reduced, since fewer corrections are necessary after choosing a wrong letter. There are different ways to increase the classification accu- racy of an EEG-based BCI. 1) In the case when only one or two EEG channels are avail- able, more advanced algorithms for the extraction of dis- crimination-relevant features might be used (e.g., adap- tive autoregressive filtering [5]) and/or better classifiers might be employed [e.g., finite impulse response (FIR) multilayer perceptrons] [6], [7]. 2) The use of multiple EEG channels to acquire additional information about the state of the brain. Recently, an analysis of multichannel EEG data has shown that classification accuracy can be increased by training an artificial neural network for each EEG channel and combining all net- works to a committee [8]. A different approach used specifically designed spatial filters obtained by the method of common spa- tial patterns (CSP) to construct very few new time-series whose variances contained the most discriminative information. These were classified by a linear discriminator [9]. The method of common spatial patterns was first applied to EEG for detection of abnormalities [10] and later used to dis- criminate movement-related patterns [9]. The method of CSP is based on a decomposition of the raw EEG signals into spatial patterns, which are extracted from two populations of single trial EEG. These patterns maximize the difference between the popu- lations. In this study, one population consists of EEG recordings 1063–6528/00$10.00 © 2000 IEEE 442 IEEE TRANSACTIONS ON REHABILITATION ENGINEERING, VOL. 8, NO. 4, DECEMBER 2000 during left motor imagery and the other population consists of right motor imagery data. The goal of this paper is to apply the method of CSP to 56-channel EEG recordings obtained during right and left motor imagery and to investigate whether multiple channels can im- prove the classification accuracy as compared to two channels. The CSP method is applied to common reference EEG data and to computed reference-free data. II. METHODS A. Experiment and Data Acquisition 1) Subjects: Three female right-handed subjects (age 20–27 years) took part in the study. The student volunteers were paid for their participation. 2) Procedure: The subjects were seated in an armchair and looked at a computer monitor placed approximately 2 m in front at eye level. They were asked to keep their arms and hands re- laxed and to avoid eye movements during the recordings. Each trial started with the presentation of a fixation cross at the center of the monitor, followed by a short warning tone (“beep”) at 2 s (Fig. 1). At 3 s, the fixation cross was overlaid with an arrow at the center of the monitor for 1.25 s, pointing either to the right or to the left (“cue”). Depending on the direction of the arrow, the subject was instructed to imagine a movement of the right or the left hand. The sequence of right and left trials, as well as the duration of the breaks between consecutive trials (ranging between 0.5 and 2.5 s), was randomized. Thus, the interval be- tween consecutive cue stimuli was at least 9 s. The experiment comprised four experimental runs of 40 trials each (20 left and 20 right trials). 3) Recordings: EEG was recorded referentially from 56 Ag/AgCl electrodes placed over central and related areas, equally spaced with approximately 2.5 cm distance. The refer- ence electrode was mounted on the right ear and the grounding electrode on the forehead. The EEG was filtered in a 0.5–50 Hz frequency band. Electrooculogram (EOG) was derived bipolarly using two electrodes, one placed medially above and the other laterally below the right eye. In addition, the surface electromyogram (EMG) was obtained from the RAMOSER et al.: SPATIAL FILTERING OF SINGLE TRIAL EEG 443 equalizes the variances in the space spanned by 444 IEEE TRANSACTIONS ON REHABILITATION ENGINEERING, VOL. 8, NO. 4, DECEMBER 2000 are plotted in grayscale symmetric to zero to allow for easier comparison. Left motor imagery causes a relatively increased EEG variance over the left hemisphere because on the contralateral hemisphere, event-related desynchronization of EEG takes place. This behavior is reflected in large coefficients for electrodes on the left hemisphere in the most important spatial pattern. Mirrored behavior can be seen for right motor imagery. The most important patterns show their strongest modulation at electrodes above the motor cortex. The pattern for left motor imagery is focused at electrode C3 overlaying the hand area. However, the focus for right imagery is at electrodes slightly anterior to C4. The second most important patterns do not ex- hibit a clear focus at specific electrodes. C. Subjects Figs. 3–5 display the most important spatial patterns for all subjects with referential, small Laplacian, and bipolar refer- ences. The patterns for all referencing methods are very similar. Be- cause of the spatial filtering properties of the small Laplacian reference (actually, this reference approximates a spatial second derivative), it shows more distinct spatial differences. For each subject, the focus of the patterns is at the same electrodes regardless of the referencing method, and, generally, electrodes overlaying the hemisphere opposite to the focus have coefficients close to zero. For none of the subjects are the pat- terns for left and right imagery are centered exactly at C3 and C4, which are currently used for EEG classification in the BCI project [3]. Especially in the right hemisphere, the electrode with maximum discriminatory power is anterior to C4 for sub- ject S1 and posterior to C4 for subjects S2 and S3. This dis- placement of the focus relative to electrodes C3 and C4 partly explains the increase in classification accuracy with multiple channels with respect to a two-channel montage. IV. DISCUSSION All three subjects have participated in a series of motor imagery sessions (left versus right hand) with delayed feedback and two bipolar EEG channels prior to the reported multi- channel experiment [3]. The best classification results in these sessions were 91.3% for subject S1, 83.7% for S2, and 89.9% for S3. These results were obtained online in a feedback session whereby in each subject, the bandpower of two optimized narrow frequency bands was classified. The use of the common spatial patterns method increases the classification accuracy between 1% (subject S1) and 10% (subject S3), even though in the multichannel experiment no feedback was given. From the inspection of the ERD time course calculated for electrodes C3 and C4 during left and right motor imagery in experiments with and without feedback, it can be expected that in the latter case the classification accuracy is lower [3, Fig. 3]. Imagination of left (right) movement leads to reduced ampli- tude of sensorimotor rhythms over the right (left) hemisphere. The topographical display of the ERD during motor imagery in subjects S1, S2, and S3 showed a focal ERD over the con- tralateral primary sensorimotor area. Additionally, in two of the Fig. 2. Most important and second most important spatial patterns for the discrimination of left from right motor imagery. Subject S1, referential recording, 56 channels. Electrode positions are marked with a black dot except for electrodes C3 (left) and C4 (right), which are marked with a “+ .” All electrodes are arranged in a grid of 2.5-cm spacing. Fig. 3. Most important spatial patterns for the detection of left and right motor imagery for each subject and referential recording, 56 channels. See Fig. 2 for further explanation. subjects (S2 and S3), ipsilateral event-related synchronization (ERS) was present [16, Fig. 2]. It is therefore not surprising that the relative increase of EEG variance as indicated in the spatial patterns is focused on the ipsilateral side. In online experiments with two bipolar EEG channels, the most reactive frequency bands were 9–13 Hz for subject S1, 10–12 Hz for S2, and 22–29 Hz for S3 [16]. In these bands, the EEG reactivity (i.e., ERD and ERS) was most impressive and RAMOSER et al.: SPATIAL FILTERING OF SINGLE TRIAL EEG 445 Fig. 4. Most important spatial patterns for the detection of left and right motor imagery for each subject and small Laplacian reference, 30 channels. See Fig. 2 for further explanation. showed largest differences between both imagination tasks. The analyzed frequency band of 8–30 Hz covers all of these most re- active frequency components. It is of interest that especially in subject S3 with a reactive beta frequency band, the classification results with the CSP method are close to 100%. In this subject, classification of two channels (large Laplacian reference) results already in an accuracy of 93%. This can be interpreted that for subject S3, the most relevant information for differentiation of left and right motor imagery is in the central beta rhythm located at the Rolandic region. In the other subjects, a more widespread activity in the alpha band explains the relatively poor classifica- tion results with two channels and the improvement with addi- tional channels. The major problem in the application of the method presented in this paper is the sensitivity to artifacts in the EEG. In the re- ported study, we use the sample covariance to estimate the co- variance matrices, which are the basis for calculation of the spa- tial filters. This estimator is known to be nonrobust. Since the covariance matrices are estimated with a comparatively small number of examples (e.g., 100 trials with 192 samples each for a56 446 IEEE TRANSACTIONS ON REHABILITATION ENGINEERING, VOL. 8, NO. 4, DECEMBER 2000 REFERENCES [1] S. C. Gandevia and J. C. Rothwell, “Knowledge of motor commands and the recruitment of human motoneurons,” Brain, vol. 110, no. 5, pp. 1117–1130, 1987. [2] G. Pfurtscheller, “Graphical display and statistical evaluation of event- related desynchronization (ERD),” Electroenc. Clin. Neurophys., vol. 43, pp. 757–760, 1977. [3] G. Pfurtscheller, C. Neuper, D. Flotzinger, and M. Pregenzer, “EEG- based discrimination between imagination of right and left hand move- ment,” Electroenc. Clin. Neurophys., vol. 103, no. 5, pp. 1–10, 1997. [4] J. R. Wolpaw, D. J. McFarland, G. W. Neat, and C. A. Forneris, “An EEG-based brain-computer interface for cursor control,” Electroenc. Clin. Neurophys., vol. 78, pp. 252–259, 1991. [5] G. Pfurtscheller, C. Neuper, A. Schloegl, and K. Lugger, “Separability of EEG signals recorded during right and left motor imagery using adap- tive autoregressive parameters,” IEEE Trans. Rehab. Eng., vol. 6, pp. 316–325, Sept. 1998. [6] E. Haselsteiner and G. Pfurtscheller, “Using time dependent neural net- works for EEG classification,” IEEE Trans. Rehab. Eng., vol. 6, pp. 457–463, Dec. 2000. [7] S. Haykin, Neural Networks: A Comprehensive Foundation.New York: Macmillan, 1994. [8] B. O. Peters, G. Pfurtscheller, and H. Flyvbjerg, “Prompt recognition of brain states by their EEG signals,” Theory Biosci., vol. 116, pp. 290–301, 1997. [9] J. Müller-Gerking, G. Pfurtscheller, and H. Flyvbjerg, “Designing op- timal spatial filters for single-trial EEG classification in a movement task,” Electroenc. Clin. Neurophys., 1999, to be published. [10] Z. J. Koles, “The quantitative extraction and topographic mapping of the abnormal components in the clinical EEG,” Electroenc. Clin. Neu- rophys., vol. 79, pp. 440–447, 1991. [11] D. J. McFarland, L. M. McCane, S. V. David, and J. R. Wolpaw, “Spatial filter selection for EEG-based communication,” Electroenc. Clin. Neu- rophys., vol. 103, no. 3, pp. 386–394, 1997. [12] G. Pfurtscheller, “Mapping of event-related desynchronization and type of derivation,” Electroenc. Clin. Neurophys., vol. 70, pp. 190–193, 1988. [13] , “Mapping procedures,” in Digital Biosignal Processing,R. Weitkunat, Ed: Elsevier, 1991, vol. 5, Techniques in Behavioral and Neural Sciences. [14] K. Fukunaga, Introduction to Statistical Pattern Recognition, 2nd ed. New York: Academic , 1990. [15] R. O. Duda and P. E. Hart, Pattern Classification and Scene Anal- ysis. New York: Wiley, 1973. [16] G. Pfurtscheller and C. Neuper, “Motor imagery activates primary sen- sorimotor areas,” Neurosci. Lett., vol. 239, pp. 65–68, 1997. [17] private communication. Herbert Ramoser received the M.Sc. degree in telematics from the Graz Uni- versity of Technology, Austria, in 1997, where he is currently pursuing the Ph.D. degree. He is currently a Research Associate with the Graz University of Tech- nology. His primary research interests are blind separation techniques, signal processing, and application of neural networks. Currently, his research focuses on spatial properties of EEG and sleep analysis. Johannes Müller-Gerking received the master’s degree in physics from the University of Constance, Germany, in 1990 and the Ph.D. degree in cognitive sciences from the Université de Paris VI, France, in 1995. From 1991 to 1994, he was a Fellow of the Gottlieb Daimler- and Karl Benz- Stiftung, Germany. Until 1996, he was a Research Assistant at NSMA, Univer- sity of Arizona. He was a Member of the Von Neuman Institute for Computing at the Research Center Jülich, Germany. His area of expertise is linear and non- linear time series analysis of electrophysiological signals. Gert Pfurtscheller received the M.Sc. and Ph.D. degrees in electrical engi- neering from Graz University of Technology, Austria, in 1964 and 1966, re- spectively. He is a Professor of medical informatics at the Institute of Biomedical En- gineering, Graz University of Technology. Since 1982, he has been Head of the Department of Medical Informatics, and since 1987 Director of the Ludwig Boltzmann-Institute for Medical Informatics and Neuroinformatics. He has au- thored more than 300 scientific articles and four books. His scientific interests and current research work include biomedical signal processing with special emphasis on electrical brain activity analysis, brain–computer communication systems, and medical expert systems.","libVersion":"0.3.1","langs":""}