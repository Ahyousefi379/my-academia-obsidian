{"path":"media/2014_Materka_Robust-BCI.pdf","text":"Manuscript of the below-titled paper, published in Z. S. Hippe, J. L. Kulikowski, T. Mroczek, and J. Wtorek, Human-Computer Systems Interaction: Backgrounds and Applications 3. Advances in Intelligent Systems and Computing Vol. 300, Springer 2014, pp 3-14. A Robust Asynchronous SSVEP Brain- Computer Interface Based On Cluster Analysis of Canonical Correlation Coefficients A. Materka 1, P. Poryzała 1 1Institute of Electronics, Lodz University of Technology, Łódź, POLAND, {andrzej.materka, pawel.poryzala}@p.lodz.pl Abstract. Brain computer interface (BCI) systems allow a natural interaction with machines, especially needed by people with severe motor disabilities or those whose limbs are occupied with other tasks. As the electrical brain activity (EEG) is measured on the user scalp in those systems, they are noninvasive. However, due to small amplitude of the relevant signal components, poor spatial resolution, diversity within users’ anatomy and EEG responses, achieving high speed and ac- curacy at large number of interface commands is a challenge. It is postulated in this paper that the SSVEP BCI paradigm, combined with multichannel filtering can provide the interface robustness to user diversity and electrode placement. A cluster analysis of the canonical correlation coefficients (computed for multi- channel EEG signals evoked by alternate visual half-field LED stimulation) is used to achieve this goal. Experimental results combined with computer simula- tion are presented to objectively evaluate the method performance. 1 Introduction The number of “smart” devices and appliances around us grows quickly in the last decades. Not even computers, tablets, cellular phones do comprise a processor with a complex program. Operation and performance of cars, washing machines, microwave ovens, TV sets, etc. strongly depend on the computational power and quality of software of the digital electronic systems embedded in it. Still, the rate of progress in the performance of the computational systems is not accompanied by an equally fast development of the interfaces necessary for information ex- change between machines and their users. In particular, there is a need to develop interfaces that would allow users, who cannot move their limbs, cannot speak, but whose mind operates normally, to en- ter data into computers without involving the traditional motor pathways of the human nervous system. A solution is a brain-computer interface (BCI) [Wolpaw et al. 2000]. In those interfaces, the intention/will of a user is not expressed by any movement, gesture or command; it is rather “guessed” by the analysis of some measured signals that reflect the brain activity. Research projects aimed at development of noninvasive BCI started about 40 years ago. The key factors of focus are speed, number of independent symbols that can be transmitted over the interface and accuracy (lowest error rate). Howev- er, due to small amplitude of the signal components, poor spatial resolution, diver- sity within users’ EEG responses, electrode misplacement, and impedance prob- lems its functionality is still far from the expectations. This gives motivation to further research on the interface performance improvement. In this paper, spatial filtering of the multi-electrode signals is used to make the SSVEP BCI robust to the measurement electrodes displacement and diversity within the operators’ EEG responses. The SSVEP paradigm is believed to ensure fastest operation of the interface [Materka and Poryzala 2013]. The asynchronous BCI operation is optimized by identifying best weighted combinations of electrode signals – with the use of cluster analysis of canonical correlation coefficients. Re- sults of experiments with 21 volunteered BCI users are described and discussed to demonstrate the developed method superiority over a number of known alternative techniques. 2 Brain Computer Interfaces In a brain–computer interface system, users perform mental tasks that invoke specific patterns of brain activity. Those may be invoked by an external stimula- tion (such as light or sound) or a mental effort of user solely (Fig. 1). The EEG signal is measured, and its relevant features extracted, after necessary prepro- cessing. A pattern recognition system determines which brain activity pattern a user’s brain is producing and thereby infers the user’s mental task, thus allowing users to send messages or commands through their intentional brain activity alone. Any particular activity is attributed to a unique symbol transmitted through the in- terface. The present technological advancement limits applications of the BCIs to a simple cellular phone keyboard with a dozen or so keys or a few-command ma- nipulator for control of a prosthetic or a virtual reality game. The main beneficiar- ies of the interface are now handicapped persons. It is expected, as BCIs become sufficiently fast, reliable and easy to use, the range of their future applications will encompass many other groups of users. Most of the phenomena observed in EEG recordings originate in surface layers of the brain cortex, where majority of neurons are positioned perpendicularly to the surface. Due to large number of mutual connections of the cortex neurons, the subsequent waves of depolarization/polarization of their cellular membranes cause synchronization of their activity [Niedermeyer and Silva 2005]. The synchronous activity of a population of nervous cells leads to changes of electric potential on the surface of the cortex, and consequently, on the surface of the skin. The recording of EEG signal is performed by measuring differences of electric potential between selected points defined on the surface of the human head. Ex- ample of standardized locations of the electrodes, defined in 1958 [Oostenveld and Praamstra 2001] to make the measurement points independent of the actual size of the skull is the well-known “ten-twenty” system. Fig. 1 Basic functional blocks of a brain-computer interface. Optional elements are marked with broken lines. The potential measured on an electrode is a sum of potentials generated by mil- lions of neurons. Thus the measured signals are an average of signals from indi- vidual neurons located over some area of the cortex. That is why EEG features poor spatial resolution. Moreover, the potentials of individual neurons have to pass the regions filled with cerebrospinal fluid, bones of the skull and through the skin until finally they reach the electrodes. This causes severe attenuation of the functional waves. The EEG signal that represents electrical brain activity is then very weak, its values are in the range of tens of microvolts. Moreover, the meas- ured signal contains not only the brain activity components of interest. There are other, sometimes many times larger components present (in the order of milli- volts), called artifacts. Their sources are of technical or biological origin. The fact that the EEG signal components that carry the information about the brain activity are weak and are buried in large-amplitude noise makes detection of the BCI user intention difficult. This is the main drawback of the EEG-based brain-computer interfaces. Significant efforts have been taken to design and built EEG measurement devices that would suppress the artifacts and reduce the power of noise relative to the brain signal components of interest [Mason et al. 2007]. One of the latest projects along these lines is described in [Zander et al. 2011]. Advanced signal processing algorithms is another means that leads to reliable de- tection of the components generated with users intentions. Four basic categories of noninvasive BCIs have been described in the literature. These categories are related to the brain electrical activity that is invoked, detected and used for sending messages or commands to machine [Wolpaw et al. 2002]. Accordingly, the BCIs use P300 potentials, SSVEP, slow cortical potentials and event-related desynchronization (ERD). To compare performance of different BCI systems, one should use some stand- ard evaluation criteria [Schlogl et al. 2007]:  Detection time (a time period between the moment user starts to express their intention to the moment of taking decision by the system).  Classification accuracy (a ratio of true positive classifications to the sum of true positive, false positive and false negative ones).  Information transfer rate (bit rate, a parameter used to estimate a theoreti- cal rate of information transfer to the computer) [Kronegg et al. 2005]. The most promising type of the BCI is based on steady-state visual evoked po- tentials (SSVEP). Relatively large information transfer rate and the number of dis- tinct messages are achieved with the use of the SSVEP-based BCIs [Zhu et al. 2010]. At the same time, high accuracy and speed are obtained at rather small training effort of the user. Thus this type of BCI is the subject of research project discussed in the next Sections. 3 SSVEP BCIs Most of the SSVEP BCI systems use frequency encoding of the messages. Therefore, detection of potentials generated in result of user’s intention is usually based on amplitude or power spectrum analysis (Fig. 2). Fig. 2 An SSVEP BCI system with frequency encoding. Referring to Fig. 2, the user concentrates his/her sight on one element (intended to be selected – a target) of the photo-stimulator. Each target is a light source flickering with a unique frequency. There is a message or command attributed to each frequency, so the stimulator plays a role of a virtual keyboard [Materka et al. 2007]. When user focuses his/her attention on a light source of a specified fre- quency, EEG signals (especially from above primary visual primary cortex) in- clude components of the same frequency and/or its harmonics [Regan 1989]. It is measured over the user’s skull and its amplitude spectrum is computed. In the ex- ample illustrated by Fig. 2, the user is looking at the stimulator element that is flickering with the frequency of 7 Hz. The SSVEP response is composed of the fundamental frequency, its second and third harmonic, 7 Hz, 14 Hz and 21 Hz, re- spectively. In the classical, spectrum analysis based approach, for each stimulation fre- quency the signal to background ratio (SBR) is computed from the EEG spectrum with the use of Fast Fourier Transform. The background noise could be e.g. the to- tal power of spectrum components in a neighborhood of a given frequency. When the SBR ratio exceed a predefined threshold, a symbol attributed to that frequency of stimulation [Middendorf et al. 2000; Trejo et al. 2006] is decided to be generat- ed at the interface output. In some works, the amplitude of the SBR coefficient is considered a signal feature, which is classified with the use of linear discriminant analysis [Luo and Sullivan 2010]. Other methods include autoregressive spectral analysis [Allison et al. 2008] and wavelet decomposition [Wu and Yao 2008]. The signal-to-background ratio is an essential characteristic of the SSVEP sig- nal. Larger values of SBR lead to shorter time of taking decision and increase the BCI accuracy. Typical stimulators have a form of rectangular fields displayed on an LCD computer screen, each flickering with a different frequency [Cheng et al. 2002]. But it is worthwhile to optimize the visual stimulation to increase the dif- ference between the power of the SSVEP and noise (for e.g. using alternate half- field stimulation method can increase SBR value [Materka and Byczuk 2006]). Even if the stimulus has been optimized and care has been taken to design measurement equipment as to obtain high signal-to-noise ratio, still the EEG sig- nal is weak and noisy. Then, further signal processing and advanced VEP detec- tion techniques are needed to ensure high accuracy, speed and capacity (i.e. the number of different messages sent over the interface). Taking into account indi- vidual anatomical and psycho-physiological differences between users, it is diffi- cult to tell in advance what is the right position for the EEG electrodes to capture most of the information related to BCI users intention. On the other hand, it is im- practical to use, say 22 electrodes covering densely the whole skin area on the head. Thus, as a compromise, a limited number of channels (say, 8 electrodes) is considered representative to the problem. The multichannel measurements is a standard now. It is hypothesized in most research projects that some linear or nonlinear com- binations of the channels, individualized for each user, carry the information which is searched for [Cichocki et al. 2008]. An example of obtaining a linear combination (spatial filtering) of the multichannel EEG recordings is shown in Fig. 3. The optimum linear spatial filter of Fig. 3 should produce new “channels” S for which a ratio of the power of the signal of interest to the noise power is maximum. Among different goals of this procedure, there are Best Bipolar Combination (BBC) of electrodes [Wang et al. 2004], Minimal Energy Combination (of noise), Maximum Contrast Combination (MCC) [Friman et al. 2007] and Canonical Cor- relation [Bin et al. 2009]. Those multichannel, spatial filtering based detection methods should be (to some extent) immune to small amplitudes of the signal components, poor spatial resolution, diversity within operators’ EEG responses and electrode displacement problems. Optimized, weighted combinations of elec- trode signals should be identified whenever it is possible. Fig. 3 The concept of spatial filtering of EEG signals. A novel, Cluster Analysis of Canonical Correlation Coefficients (CACC) method for detecting steady-state visual evoked potentials (SSVEP) using multiple channel electroencephalogram (EEG) data has been developed by the authors and described in [Poryzala et al 2012]. Accurate asynchronous detection, high speed and high information transfer rate can be achieved with CACC after a short cali- bration session. Spatial filtering based on the Canonical Correlation Analysis method proposed in [Bin et al. 2009] was used for identifying optimal combina- tions of electrode signals that cancel strong interference signals in the EEG. The proposed algorithm, a standard spectrum analysis approach, and two competitive spatial filtering and detection methods were evaluated in a series of experiments with the use of data from 21 subjects [Byczuk et al. 2012]. The obtained results showed a significant improvement in classification accuracy and in an average de- tection time for a large group of users. In our recent research we addressed the problem of changing the designed SSVEP-based BCI laboratory demonstration to practically applicable system. Per- formance of the device evaluated in the carefully controlled lab environment will be decreased in real world conditions, where small amplitudes of the signal com- ponents, relatively high power of noise, diversity within users’ EEG responses, electrode misplacement, and impedance problems cannot be controlled. Practical device should be convenient and comfortable to use (ideally a limited number of dry, active electrodes should be used) and its performance should be stable and re- liable in all possible working conditions [Wang et al. 2008]. Those problems have to be addressed before BCI devices can be put into practical use. In offline experiments we have evaluated how the misplacement of the meas- urement electrodes and diversity within users’ EEG responses affect the perfor- mance of the designed asynchronous Brain-Computer Interface with the CACC detection method (Fig. 4). As in [Poryzala et al 2012], users were qualified to one of three groups: Group A (best results, 5 subjects). Subjects who used the device (in our previous studies and tests). Group B (average results, 10 subjects). Subjects who were not familiar with a BCI device, but actively participated in the experiments. Group C (poor results, 6 subjects). Subjects with concentration problems or very high unstimulated, spontaneous brain activity. Fig. 4 Effect of displacement of the measurement electrodes on the parameters of the SSVEP based BCI system. For each user from Groups A, B and C, the original, 16-channel EEG data (seven electrodes over the primary visual cortex: PO7, PO3, O1, OZ, O2, PO4 and PO8; nine electrodes evenly distributed over the remaining cerebral cortex: P3, PZ, P4, C3, CZ, C4, F3, FZ and F4) were interpolated (for given displacement de- fined by shift d and rotation Θ) to the new set of eleven displaced measurement points (Fig. 5a). Data was interpolated both in space and time domain (tessella- tion-based linear interpolation) in the wide range of rotations (Θ = ±50) and shifts (d = ±4 cm). Rules for d and Θ directions are depicted in Fig. 5b. a) b) Fig. 5 Set of 11 EEG electrodes for Θ = 0 and d = 0 cm (a). Rules for d and Θ directions (b). Data for subjects were divided after the interpolation into shorter fragments, containing several stimulation patterns (extracted based on the binary stimulation on and off markers recorded along the original measurement data). The algorithm was evaluated with window length of 2.56 s. Data window step was set to 0.16 s. Results (classification accuracy, average detection times and information trans- fer rates) were evaluated in a 5º x 5 cm grid of Θ and d displacement coordinates independently in each group (Fig. 6, Fig. 7 and Fig. 8). Classification accuracy was defined as the number of correctly classified commands relative to the total number of commands classified by the system. Detection time was measured from the moment when the stimulation symbol was switched on to the moment when BCI system detected a command. Information transfer rate (amount of information which can be transferred between the human brain and the BCI system per mi- nute) was defined as:                      1 1 log1loglog 60 222 N P PPPN T B D t , (1) where N denotes the number of commands (5 in case of this particular system), P denotes classification accuracy and TD denotes average detection time. All sys- tem parameters obtained for each user, were averaged in each of the subject groups for every considered misplacement. a) classification accuracy b) average detection time c) information transfer rate Fig. 6 Parameters of the SSVEP-based BCI system for Group A. Acceptable rotation Θ = -40º - +25º, acceptable shift d = -2.5 - +3.0 cm. Additionally, acceptable rotation and shift values were determined for each case (areas on Θ-d plane, over which classification accuracy does not change by more than ±10% in terms of the value calculated for Θ = 0º and d = 0 cm). It can be observed in Figures 6, 7 and 8, that the proposed CACC method pro- vides a high tolerance for the SSVEP BCI system electrode placement. Allowable, average misplacement of the electrode set (regardless of the subjects’ group), within which none or only limited decrease of the device performance is observed can be defined in proposed displacement coordinates as rotation Θ = ±25º and shift d = ±3.0 cm. a) classification accuracy b) average detection time c) information transfer rate Fig. 7 Parameters of the SSVEP-based BCI system for Group B. Acceptable rotation Θ = -25º - +25º, acceptable shift d = -2.0 - +3.0 cm. a) classification accuracy b) average detection time c) information transfer rate Fig. 8 Parameters of the SSVEP-based BCI system for Group C. Acceptable rotation Θ = -45º - +45º, acceptable shift d = -3.5 - +4.0 cm. 4 Summary and conclusions It has been shown the SSVEP is a promising paradigm for fast and accurate brain-computer interfaces. The results of our offline experiments demonstrated that the proposed CACC detection method provides stable performance, robust- ness and reliability in a wide range of measurement electrode misplacements and diversity within users’ EEG responses. It is able to identify optimized, weighted combinations of electrode signals and compensates shifts of the electrodes set on top of the subject’s head for a large group of users within rotations of ±25° and displacements of up to ±3 cm. This shows its potential to account for individual user anatomical and physiological characteristics. It also proves, that the optimiza- tion of SSVEP detection algorithms and their hardware/software implementation for real time SSVEP detection is an important research avenue. But it must be re- membered that the BCI research and its various possible applications raise im- portant ethical issues that need to be discussed in different communities to pro- mote acceptance and develop adequate policies [Nijboer et al. 2011]. References [Allison et al. 2008] Allison BZ, McFarland DJ, Schalk G, Zheng SD, Jackson MM, Wolpaw JR (2008) Towards an inde- pendent brain-computer interface using steady state visual evoked potentials. Clin Neurophysiol, 119(2):399–408 [Bin et al. 2009] Bin G, Gao X, Yan Z, Hong B, Gao S (2009) An online multi-channel SSVEP-based brain-computer interface using a canonical correlation analysis. J Neural Eng 6(4):046002 [Byczuk et al. 2012] Byczuk M, Poryzala P, Materka A (2012) On diversity within operators’ responses to LED-produced alternate stimulus in SSVEP BCI. Bull Polish Acad Sci 60(3):7 pages [Cichocki et al. 2008] Cichocki A, Washizawa Y, Rutkowski T, Bakardjian H, Phan AH (2008) Noninvasive BCIs: Multiway Signac processing array decompositions. IEEE Computer 10:34-42 [Cheng et al. 2002] Cheng M, Gao X, Gao S, Xu D (2002) Design and implementation of a brain-computer interface with high transfer rates, IEEE Trans Biomed Eng 49(10):1181-1186 [Friman et al. 2007] Friman O, Volosyak I, Graser A (2007) Multiple channel detection of steady-state visual evoked poten- tials for brain-computer interfaces. IEEE Trans Biomed Eng 54(4):742–750 [Kronegg et al. 2005] Kronegg J, Voloshynovskij S, Pun T (2005) Analysis of bit rate definitions for brain-computer inter- faces. Int Conf Human-Computer Interaction, Las Vegas NA [Luo and Sullivan 2010] Luo A, Sullivan TJ (2010) A user-friendly SSVEP-based brain-computer interface using a time- domain classifier. J Neural Eng 7(2):26010 [Mason et al. 2007] Mason SG, Bashashati A, Fatourechi M, Navarro KF, Birch GE (2007) A comprehensive survey of brain interface technology designs. Ann Biomed Eng 35:137–69 [Materka and Byczuk 2006] Materka A, Byczuk M (2006) Alternate half-field stimulation technique for SSVEP-based brain- computer interfaces. Electronics Letters 42(6):321-322 [Materka et al. 2007] Materka A, Byczuk M, Poryzala P (2007) A virtual keypad based on alternate half-field stimulated visual evoked potentials, Proc. IEEE Symp. Information Technology Convergence, Chonbuk Korea: 297-300 [Materka and Poryzala 2013] Materka A, Poryzala P (2013) High-speed noninvasive brain-computer interfaces. 6th Int Conference on Human System Interaction, pp. 7–12. [Middendorf et al. 2000] Middendorf M, McMillan G, Calhoun G, Jones KS (2000) Brain–computer interfaces based on the steady-state visual-evoked response. IEEE Trans Rehabil Eng 8:211-214 [Niedermeyer and Silva 2005] Niedermeyer E, Silva FHL (2005) Electroencephalography: Basic principles, clinical applications, and related fields. Lippincott Williams and Wilkins, Baltimore ML, pp. 991–1002 [Nijboer et al. 2011] Nijboer F, Clausen J, Allison BZ, Haselager P (2011) The Asilomar survey: Stakeholders’ opinions on ethical issues related to brain-computer interfacing. Neuroethics 6(3): 541-578 [Oostenveld and Praamstra 2001] Oostenveld R, Praamstra P (2001) The five percent electrode system for high-resolution EEG and ERP measurements, Clinical Neurophysiology 112:713-719 [Poryzala et al. 2012] Poryzala P. Materka A, Byczuk M (2012) Cluster analysis of canonical correlation coefficients for the SSVEP based brain-computer interfaces. IEEE Conf. NTAV/SPA 2012: 149-154 [Regan 1989] Regan D (1989) Human brain electrophysiology-evoked potentials and evoked magnetic fields in sci- ence and medicine. Elsevier, New York [Schlogl et al. 2007] Schlogl A, Kronegg J, Huggins JE, Mason SG (2007) Evaluation criteria for BCI research. In: Toward Brain-Computer Interfacing, MIT Press, Massachusetts: 327–342 [Trejo et al. 2006] Trejo LJ, Rosipal R, Matthews B (2006) Brain-computer interfaces for 1-D and 2-D cursor control: de- signs using volitional control of the EEG spectrum or steady-state visual evoked potentials. IEEE Trans Neural Syst Rehabil Eng 14(2):225–229 [Wang et al. 2004] Wang Y, Zhang Z, Gao X, Gao S (2004) Lead selection for SSVEP-based brain-computer interface. IEMBS ’04. 26th Annual International Conference of the IEEE on Engineering in Medicine and Biolo- gy Society. 2:4507–4510 [Wang et al. 2008] Wang Y, Gao X, Hong B, Jia C, Gao S (2008) Brain-Computer Interfaces Based on Visual Evoked Po- tentials. IEEE Eng Med Biol 27(5): 64-71 [Wolpaw et al. 2000] Wolpaw J, Birbaumer N, Heetderks W, McFarland DJ, Peckham PH, Schalk G, Donchin E, Quatrano LA, Robinson CJ, Vaughan TM (2000) Brain-computer interface technology: a review of the first in- ternational meeting. IEEE Trans Rehabil Eng, 8(2):164–173 [Wolpaw et al. 2002] Wolpaw JR, Birbaumer N, McFarland DJ, Pfurtscheller G, Vaughan TM (2002) Brain–computer inter- faces for communication and control. Clin Neurophysiol 113:767–91 [Wu and Yao 2008] Wu Z, Yao D (2008) Frequency detection with stability coefficient for steady-state visual evoked po- tential (SSVEP)-based BCIs. J Neural Eng 5(1):36–43 [Zander et al. 2011] Zander TO, Lehne M, Ihme K, Jatzev S, Correia J, Kothe C, Picht B, Nijboer F (2011) A dry EEG sys- tem for scientific research and brain-computer interfaces. Front Neurosci 5: 53 [Zhu et al. 2010] Zhu D, Bieger J, Molina GG, Aarts RM (2010) A survey of Stimulation Methods Used in SSVEP Based BCIs. Comput Intell Neurosci 2010, Article ID 702357","libVersion":"0.3.1","langs":""}